#include "sigmoid.h"


float exp_arr[1000] = {
22026.46579481f,
21589.88031554f,
21161.94837528f,
20742.49845264f,
20331.36242599f,
19928.375506f,
19533.37616965f,
19146.20609542f,
18766.71009992f,
18394.7360756f,
18030.13492986f,
17672.76052523f,
17322.46962083f,
16979.12181498f,
16642.57948884f,
16312.70775136f,
15989.37438513f,
15672.44979341f,
15361.8069482f,
15057.32133933f,
14758.87092452f,
14466.33608048f,
14179.59955499f,
13898.54641986f,
13623.06402489f,
13353.04195273f,
13088.37197458f,
12828.94800686f,
12574.66606866f,
12325.42424007f,
12081.12262132f,
11841.66329277f,
11606.95027561f,
11376.88949346f,
11151.38873458f,
10930.357615f,
10713.7075422f,
10501.35167969f,
10293.20491213f,
10089.18381126f,
9889.20660245f,
9693.19313191f,
9501.06483459f,
9312.74470267f,
9128.15725468f,
8947.22850529f,
8769.8859356f,
8596.05846414f,
8425.67641832f,
8258.67150653f,
8094.97679076f,
7934.52665978f,
7777.25680283f,
7623.10418388f,
7472.00701629f,
7323.90473812f,
7178.73798781f,
7036.44858042f,
6896.97948427f,
6760.27479811f,
6626.27972872f,
6494.94056891f,
6366.20467603f,
6240.02045086f,
6116.33731691f,
5995.1057002f,
5876.27700931f,
5759.80361597f,
5645.63883595f,
5533.73691033f,
5424.0529872f,
5316.54310363f,
5211.1641681f,
5107.8739432f,
5006.63102868f,
4907.39484492f,
4810.12561661f,
4714.78435682f,
4621.33285138f,
4529.73364357f,
4439.95001908f,
4351.94599133f,
4265.68628702f,
4181.13633201f,
4098.26223744f,
4017.03078616f,
3937.40941942f,
3859.36622382f,
3782.86991851f,
3707.88984264f,
3634.39594311f,
3562.3587625f,
3491.74942726f,
3422.53963612f,
3354.7016488f,
3288.20827484f,
3223.03286272f,
3159.1492892f,
3096.5319488f,
3035.15574358f,
2974.99607306f,
2916.02882436f,
2858.23036256f,
2801.57752119f,
2746.04759296f,
2691.61832066f,
2638.26788826f,
2585.97491211f,
2534.71843243f,
2484.47790488f,
2435.23319232f,
2386.96455675f,
2339.65265139f,
2293.27851295f,
2247.823554f,
2203.26955551f,
2159.59865961f,
2116.79336235f,
2074.83650676f,
2033.71127591f,
1993.4011862f,
1953.89008077f,
1915.16212299f,
1877.20179013f,
1839.99386713f,
1803.52344052f,
1767.77589241f,
1732.73689467f,
1698.39240316f,
1664.72865209f,
1631.73214856f,
1599.38966708f,
1567.68824431f,
1536.61517385f,
1506.15800118f,
1476.3045186f,
1447.04276042f,
1418.36099808f,
1390.24773552f,
1362.69170454f,
1335.68186027f,
1309.20737677f,
1283.2576427f,
1257.822257f,
1232.89102482f,
1208.45395335f,
1184.50124785f,
1161.02330773f,
1138.01072269f,
1115.45426895f,
1093.34490555f,
1071.67377074f,
1050.43217841f,
1029.61161463f,
1009.2037342f,
989.20035735f,
969.59346643f,
950.37520272f,
931.53786326f,
913.07389776f,
894.9759056f,
877.23663284f,
859.84896932f,
842.80594581f,
826.10073122f,
809.72662986f,
793.67707874f,
777.94564497f,
762.52602316f,
747.41203291f,
732.59761631f,
718.07683552f,
703.8438704f,
689.89301617f,
676.21868112f,
662.81538439f,
649.67775374f,
636.8005234f,
624.17853201f,
611.80672048f,
599.68013f,
587.79390007f,
576.14326651f,
564.72355958f,
553.53020209f,
542.55870758f,
531.80467851f,
521.26380452f,
510.93186067f,
500.80470575f,
490.87828067f,
481.14860677f,
471.61178425f,
462.26399061f,
453.10147912f,
444.12057732f,
435.31768552f,
426.6892754f,
418.23188856f,
409.94213517f,
401.81669257f,
393.85230396f,
386.0457771f,
378.39398302f,
370.89385476f,
363.54238618f,
356.33663069f,
349.27370011f,
342.35076353f,
335.56504613f,
328.9138281f,
322.39444353f,
316.00427935f,
309.7407743f,
303.60141787f,
297.58374932f,
291.68535668f,
285.90387578f,
280.23698933f,
274.68242595f,
269.23795929f,
263.90140714f,
258.67063052f,
253.54353286f,
248.51805915f,
243.5921951f,
238.76396636f,
234.03143769f,
229.39271225f,
224.84593075f,
220.38927077f,
216.02094604f,
211.73920565f,
207.54233342f,
203.42864719f,
199.39649812f,
195.44427008f,
191.57037896f,
187.77327204f,
184.05142739f,
180.40335323f,
176.82758737f,
173.32269658f,
169.88727606f,
166.51994884f,
163.21936525f,
159.98420235f,
156.81316346f,
153.70497758f,
150.65839889f,
147.67220628f,
144.74520285f,
141.87621541f,
139.06409402f,
136.30771156f,
133.60596321f,
130.95776608f,
128.36205873f,
125.81780077f,
123.32397242f,
120.87957412f,
118.48362611f,
116.13516807f,
113.8332587f,
111.57697536f,
109.3654137f,
107.1976873f,
105.07292729f,
102.99028204f,
100.9489168f,
98.94801336f,
96.98676972f,
95.0643998f,
93.18013307f,
91.33321431f,
89.52290322f,
87.74847423f,
86.0092161f,
84.30443172f,
82.63343779f,
80.99556454f,
79.3901555f,
77.81656719f,
76.27416889f,
74.7623424f,
73.28048174f,
71.82799297f,
70.4042939f,
69.00881391f,
67.64099365f,
66.30028489f,
64.98615025f,
63.69806301f,
62.43550688f,
61.19797582f,
59.98497379f,
58.79601462f,
57.63062175f,
56.48832807f,
55.36867574f,
54.27121598f,
53.19550892f,
52.14112339f,
51.10763679f,
50.09463487f,
49.10171161f,
48.12846904f,
47.17451705f,
46.2394733f,
45.32296301f,
44.42461882f,
43.54408067f,
42.68099562f,
41.83501774f,
41.00580794f,
40.19303387f,
39.39636975f,
38.61549627f,
37.85010044f,
37.09987549f,
36.36452071f,
35.64374136f,
34.93724854f,
34.24475908f,
33.56599542f,
32.9006855f,
32.24856266f,
31.60936551f,
30.98283785f,
30.36872857f,
29.76679151f,
29.17678542f,
28.59847382f,
28.03162489f,
27.47601146f,
26.9314108f,
26.39760466f,
25.87437905f,
25.36152427f,
24.85883477f,
24.36610904f,
23.88314961f,
23.4097629f,
22.94575915f,
22.49095241f,
22.04516036f,
21.60820434f,
21.1799092f,
20.76010328f,
20.3486183f,
19.94528936f,
19.54995477f,
19.16245609f,
18.78263801f,
18.41034828f,
18.04543768f,
17.68775996f,
17.33717176f,
16.99353254f,
16.65670458f,
16.32655287f,
16.00294508f,
15.6857515f,
15.37484501f,
15.07010097f,
14.77139725f,
14.47861412f,
14.19163424f,
13.91034256f,
13.63462636f,
13.36437511f,
13.0994805f,
12.83983635f,
12.58533859f,
12.33588522f,
12.09137626f,
11.85171369f,
11.61680147f,
11.38654542f,
11.16085328f,
10.93963456f,
10.72280061f,
10.51026451f,
10.30194108f,
10.09774682f,
9.89759989f,
9.70142006f,
9.50912869f,
9.32064873f,
9.13590461f,
8.9548223f,
8.77732922f,
8.60335421f,
8.43282756f,
8.26568091f,
8.10184726f,
7.94126095f,
7.78385761f,
7.62957416f,
7.47834875f,
7.33012077f,
7.18483081f,
7.04242064f,
6.90283317f,
6.76601246f,
6.63190366f,
6.50045303f,
6.37160788f,
6.24531656f,
6.12152845f,
6.00019394f,
5.88126439f,
5.76469215f,
5.65043047f,
5.53843357f,
5.42865655f,
5.32105542f,
5.21558705f,
5.11220916f,
5.01088032f,
4.91155991f,
4.81420812f,
4.71878595f,
4.62525512f,
4.53357817f,
4.44371835f,
4.35563963f,
4.26930671f,
4.184685f,
4.10174056f,
4.02044017f,
3.94075122f,
3.86264179f,
3.78608056f,
3.71103685f,
3.63748057f,
3.56538225f,
3.49471299f,
3.42544446f,
3.35754889f,
3.29099908f,
3.22576835f,
3.16183056f,
3.09916007f,
3.03773178f,
2.97752105f,
2.91850375f,
2.86065623f,
2.80395531f,
2.74837825f,
2.69390278f,
2.64050707f,
2.58816971f,
2.53686973f,
2.48658656f,
2.43730005f,
2.38899045f,
2.34163839f,
2.29522489f,
2.24973135f,
2.20513954f,
2.16143158f,
2.11858995f,
2.07659749f,
2.03543735f,
1.99509305f,
1.95554841f,
1.91678758f,
1.87879503f,
1.84155553f,
1.80505415f,
1.76927626f,
1.73420752f,
1.69983388f,
1.66614156f,
1.63311705f,
1.60074712f,
1.56901879f,
1.53791935f,
1.50743633f,
1.47755751f,
1.44827091f,
1.41956481f,
1.39142768f,
1.36384826f,
1.3368155f,
1.31031854f,
1.28434678f,
1.25888981f,
1.23393742f,
1.20947961f,
1.18550657f,
1.16200871f,
1.13897659f,
1.11640099f,
1.09427286f,
1.07258333f,
1.05132371f,
1.03048548f,
1.01006028f,
0.99003992f,
0.97041639f,
0.95118182f,
0.93232849f,
0.91384885f,
0.8957355f,
0.87798117f,
0.86057875f,
0.84352126f,
0.82680187f,
0.81041387f,
0.7943507f,
0.77860591f,
0.7631732f,
0.74804639f,
0.7332194f,
0.71868629f,
0.70444125f,
0.69047855f,
0.67679261f,
0.66337794f,
0.65022916f,
0.637341f,
0.62470829f,
0.61232598f,
0.6001891f,
0.58829278f,
0.57663226f,
0.56520286f,
0.554f,
0.54301919f,
0.53225604f,
0.52170622f,
0.5113655f,
0.50122975f,
0.4912949f,
0.48155697f,
0.47201206f,
0.46265633f,
0.45348604f,
0.44449752f,
0.43568715f,
0.42705142f,
0.41858686f,
0.41029007f,
0.40215773f,
0.39418658f,
0.38637343f,
0.37871514f,
0.37120864f,
0.36385094f,
0.35663907f,
0.34957014f,
0.34264133f,
0.33584985f,
0.32919299f,
0.32266807f,
0.31627248f,
0.31000366f,
0.30385909f,
0.29783632f,
0.29193292f,
0.28614653f,
0.28047484f,
0.27491556f,
0.26946647f,
0.26412539f,
0.25889017f,
0.25375872f,
0.24872898f,
0.24379894f,
0.23896661f,
0.23423007f,
0.22958741f,
0.22503676f,
0.22057632f,
0.21620429f,
0.21191892f,
0.20771848f,
0.2036013f,
0.19956573f,
0.19561015f,
0.19173297f,
0.18793264f,
0.18420764f,
0.18055647f,
0.17697767f,
0.1734698f,
0.17003146f,
0.16666128f,
0.16335789f,
0.16011999f,
0.15694626f,
0.15383543f,
0.15078627f,
0.14779754f,
0.14486805f,
0.14199663f,
0.13918212f,
0.1364234f,
0.13371936f,
0.13106891f,
0.128471f,
0.12592459f,
0.12342864f,
0.12098217f,
0.11858419f,
0.11623374f,
0.11392987f,
0.11167167f,
0.10945824f,
0.10728867f,
0.10516211f,
0.10307769f,
0.1010346f,
0.09903199f,
0.09706909f,
0.09514508f,
0.09325922f,
0.09141073f,
0.08959888f,
0.08782295f,
0.08608221f,
0.08437598f,
0.08270357f,
0.08106431f,
0.07945754f,
0.07788261f,
0.07633891f,
0.0748258f,
0.07334268f,
0.07188896f,
0.07046405f,
0.06906738f,
0.0676984f,
0.06635656f,
0.06504131f,
0.06375213f,
0.0624885f,
0.06124992f,
0.06003588f,
0.05884592f,
0.05767953f,
0.05653627f,
0.05541567f,
0.05431728f,
0.05324066f,
0.05218538f,
0.05115101f,
0.05013715f,
0.04914339f,
0.04816932f,
0.04721456f,
0.04627872f,
0.04536143f,
0.04446232f,
0.04358104f,
0.04271722f,
0.04187052f,
0.04104061f,
0.04022715f,
0.03942981f,
0.03864827f,
0.03788223f,
0.03713136f,
0.03639538f,
0.03567399f,
0.0349669f,
0.03427382f,
0.03359448f,
0.03292861f,
0.03227593f,
0.03163619f,
0.03100913f,
0.0303945f,
0.02979206f,
0.02920155f,
0.02862275f,
0.02805542f,
0.02749933f,
0.02695427f,
0.02642001f,
0.02589634f,
0.02538305f,
0.02487993f,
0.02438679f,
0.02390342f,
0.02342963f,
0.02296523f,
0.02251004f,
0.02206387f,
0.02162654f,
0.02119789f,
0.02077772f,
0.02036589f,
0.01996222f,
0.01956655f,
0.01917872f,
0.01879858f,
0.01842597f,
0.01806075f,
0.01770277f,
0.01735189f,
0.01700796f,
0.01667084f,
0.01634041f,
0.01601653f,
0.01569906f,
0.01538789f,
0.01508289f,
0.01478393f,
0.0144909f,
0.01420368f,
0.01392215f,
0.0136462f,
0.01337572f,
0.0131106f,
0.01285073f,
0.01259602f,
0.01234636f,
0.01210164f,
0.01186177f,
0.01162666f,
0.01139621f,
0.01117033f,
0.01094892f,
0.0107319f,
0.01051918f,
0.01031068f,
0.01010632f,
0.009906f,
0.00970965f,
0.0095172f,
0.00932856f,
0.00914366f,
0.00896242f,
0.00878478f,
0.00861066f,
0.00843998f,
0.0082727f,
0.00810872f,
0.007948f,
0.00779046f,
0.00763605f,
0.0074847f,
0.00733634f,
0.00719093f,
0.0070484f,
0.00690869f,
0.00677175f,
0.00663753f,
0.00650597f,
0.00637702f,
0.00625062f,
0.00612672f,
0.00600529f,
0.00588626f,
0.00576958f,
0.00565523f,
0.00554313f,
0.00543326f,
0.00532557f,
0.00522001f,
0.00511655f,
0.00501513f,
0.00491573f,
0.00481829f,
0.00472279f,
0.00462918f,
0.00453743f,
0.00444749f,
0.00435934f,
0.00427293f,
0.00418824f,
0.00410522f,
0.00402385f,
0.0039441f,
0.00386592f,
0.00378929f,
0.00371419f,
0.00364057f,
0.00356841f,
0.00349768f,
0.00342835f,
0.0033604f,
0.00329379f,
0.00322851f,
0.00316451f,
0.00310179f,
0.00304031f,
0.00298005f,
0.00292098f,
0.00286308f,
0.00280634f,
0.00275071f,
0.00269619f,
0.00264275f,
0.00259037f,
0.00253902f,
0.0024887f,
0.00243937f,
0.00239102f,
0.00234363f,
0.00229717f,
0.00225164f,
0.00220701f,
0.00216327f,
0.00212039f,
0.00207836f,
0.00203716f,
0.00199679f,
0.00195721f,
0.00191841f,
0.00188039f,
0.00184312f,
0.00180659f,
0.00177078f,
0.00173568f,
0.00170128f,
0.00166756f,
0.0016345f,
0.00160211f,
0.00157035f,
0.00153922f,
0.00150872f,
0.00147881f,
0.0014495f,
0.00142077f,
0.00139261f,
0.00136501f,
0.00133795f,
0.00131143f,
0.00128544f,
0.00125996f,
0.00123498f,
0.00121051f,
0.00118651f,
0.00116299f,
0.00113994f,
0.00111735f,
0.0010952f,
0.00107349f,
0.00105222f,
0.00103136f,
0.00101092f,
0.00099088f,
0.00097124f,
0.00095199f,
0.00093312f,
0.00091462f,
0.0008965f,
0.00087873f,
0.00086131f,
0.00084424f,
0.0008275f,
0.0008111f,
0.00079502f,
0.00077927f,
0.00076382f,
0.00074868f,
0.00073384f,
0.0007193f,
0.00070504f,
0.00069106f,
0.00067737f,
0.00066394f,
0.00065078f,
0.00063788f,
0.00062524f,
0.00061285f,
0.0006007f,
0.00058879f,
0.00057712f,
0.00056568f,
0.00055447f,
0.00054348f,
0.00053271f,
0.00052215f,
0.0005118f,
0.00050166f,
0.00049171f,
0.00048197f,
0.00047241f,
0.00046305f,
0.00045387f,
0.00044487f,
0.00043606f,
0.00042741f,
0.00041894f,
0.00041064f,
0.0004025f,
0.00039452f,
0.0003867f,
0.00037904f,
0.00037152f,
0.00036416f,
0.00035694f,
0.00034987f,
0.00034293f,
0.00033613f,
0.00032947f,
0.00032294f,
0.00031654f,
0.00031027f,
0.00030412f,
0.00029809f,
0.00029218f,
0.00028639f,
0.00028071f,
0.00027515f,
0.0002697f,
0.00026435f,
0.00025911f,
0.00025397f,
0.00024894f,
0.00024401f,
0.00023917f,
0.00023443f,
0.00022978f,
0.00022523f,
0.00022076f,
0.00021639f,
0.0002121f,
0.00020789f,
0.00020377f,
0.00019974f,
0.00019578f,
0.0001919f,
0.00018809f,
0.00018436f,
0.00018071f,
0.00017713f,
0.00017362f,
0.00017018f,
0.0001668f,
0.0001635f,
0.00016026f,
0.00015708f,
0.00015397f,
0.00015091f,
0.00014792f,
0.00014499f,
0.00014212f,
0.0001393f,
0.00013654f,
0.00013383f,
0.00013118f,
0.00012858f,
0.00012603f,
0.00012353f,
0.00012108f,
0.00011868f,
0.00011633f,
0.00011403f,
0.00011177f,
0.00010955f,
0.00010738f,
0.00010525f,
0.00010317f,
0.00010112f,
9.912e-05f,
9.715e-05f,
9.523e-05f,
9.334e-05f,
9.149e-05f,
8.967e-05f,
8.79e-05f,
8.616e-05f,
8.445e-05f,
8.277e-05f,
8.113e-05f,
7.952e-05f,
7.795e-05f,
7.64e-05f,
7.489e-05f,
7.34e-05f,
7.195e-05f,
7.052e-05f,
6.913e-05f,
6.776e-05f,
6.641e-05f,
6.51e-05f,
6.381e-05f,
6.254e-05f,
6.13e-05f,
6.009e-05f,
5.89e-05f,
5.773e-05f,
5.658e-05f,
5.546e-05f,
5.436e-05f,
5.329e-05f,
5.223e-05f,
5.119e-05f,
5.018e-05f,
4.919e-05f,
4.821e-05f,
4.725e-05f,
4.632e-05f,
4.54e-05
};




float e_to_x(const float x)
{
    return exp_arr[(x >= 1000 ? 1000 : (x < 0 ? 0 : (int)(x + 0.5f)))];
}